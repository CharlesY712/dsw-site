%section.main
  %section.content
    = render partial: 'layouts/shared/navigation'
    %section.section-container.width-constrained
      = link_to 'Back to Schedule', schedules_path, class: 'btn back-to-schedule'
      .p-copy
        %a.dswacon.dswacon-panel-icon.current-event-icon(class="dswacon-#{@session.track.icon}" title="#{@session.track.name}")
      %h1.primary-heading= @session.title

      %div.event-description<>
        %div.p-copy= process_with_pipeline(@session.description)

      %div.event-details<>
        %h3.event-details-heading Event Details
        %p.event-details-info
          = human_time_range(@session)
          %br
          - if @session.venue
            = @session.venue.name
            %br
            = @session.venue.address
          - else
            Location TBA
        %p.event-details-attending
          %span.dswacon.dswacon-people
          %span #{@session.registrants.count} People are Attending

    - if @session.venue
      %iframe.location-map(frameborder="0" src="https://www.google.com/maps/embed/v1/place?q=#{@session.venue.address_for_google_maps}&zoom=19&key=AIzaSyAvjqf7BI97ZjJRQVpuDxT3zL0Jh9hnC5c")
    %section.section-container.module-form.event-comment-section
      %h2.primary-heading Comments
      - if registered?
        %div.form-comment.event-form-comment
          = simple_form_for [ @session, Comment.new ], html: { class: 'dsw-form', role: 'form' } do |f|
            = field_set_tag do
              = f.input :body, placeholder: 'Comment on this idea...', input_html: { rows: 4 }
              %div.submit-btn-holder
                = f.button :submit, 'Submit', class: 'btn btn-primary form-btn'
      %ol.event-comments
        %li.event-comment
          - @session.comments.each do |comment|
            %em.event-comment-heading= "#{comment.user.name} said:"
            = process_with_pipeline(comment.body)

= render partial: 'layouts/shared/footer'
= render partial: 'layouts/shared/flash_message'
= render partial: 'layouts/shared/spinner'
